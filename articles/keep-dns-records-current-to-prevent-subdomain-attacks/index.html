<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Pelican" />
    <title>Why Keeping DNS Records Current is Important</title>
                <link rel="canonical" href="https://jjriv.com/articles/keep-dns-records-current-to-prevent-subdomain-attacks/">
    <link rel="stylesheet" href="https://jjriv.com/theme/css/main.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Hanken+Grotesk:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link href="https://jjriv.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="jjriv Atom Feed" />
        <meta name="description" content="Learn why keeping DNS records current is necessary to prevent attackers from taking over a subdomain." />
</head>

<body>
    <header class="container-fluid">
        <nav class="container">
            <ul>
            <li><a href="/">jjriv</a></li>
            </ul>
            <ul>
                    <li><a href="https://jjriv.com/about/" >about me</a></li>
                    <li class="active"><a href="https://jjriv.com/articles/">articles</a></li>
            <li><a href="https://github.com/jjriv/" target="_blank" title="github"><svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-github"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" /></svg></a></li>
            <li><a href="https://x.com/jjriv/" target="_blank" title="x"><svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-x"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4l11.733 16h4.267l-11.733 -16z" /><path d="M4 20l6.768 -6.768m2.46 -2.46l6.772 -6.772" /></svg></a></li>
            <li><a href="https://www.linkedin.com/in/johnjreeve/" target="_blank" title="linkedin"><svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-linkedin"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z" /><path d="M8 11l0 5" /><path d="M8 8l0 .01" /><path d="M12 16l0 -5" /><path d="M16 16v-3a2 2 0 0 0 -4 0" /></svg></a></li>
            <li><a href="https://noc.social/@jjriv" target="_blank" title="mastodon"><svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-mastodon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254c-1.816 1.763 -6.648 1.626 -6.648 1.626a18.262 18.262 0 0 1 -3.288 -.256c1.127 1.985 4.12 2.81 8.982 2.475c-1.945 2.013 -13.598 5.257 -13.668 -7.636l-.026 -1.154c0 -3.036 .023 -4.115 1.352 -5.633c1.671 -1.91 6.648 -1.666 6.648 -1.666s4.977 -.243 6.648 1.667c1.329 1.518 1.352 2.597 1.352 5.633s-.456 4.074 -1.352 4.944z" /><path d="M12 11.204v-2.926c0 -1.258 -.895 -2.278 -2 -2.278s-2 1.02 -2 2.278v4.722m4 -4.722c0 -1.258 .895 -2.278 2 -2.278s2 1.02 2 2.278v4.722" /></svg></a></li>
            </ul>
        </nav>
    </header><!-- /#banner -->
    <main class="container">
        <div class="grid">
            <div class="mask">
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://jjriv.com/articles/keep-dns-records-current-to-prevent-subdomain-attacks/" rel="bookmark"
           title="Permalink to Why Keeping DNS Records Current is Important">Why Keeping DNS Records Current is Important</a></h1>
    </header>

    <div class="entry-content">
      <!-- Status: draft -->

<p>Managing DNS records can be a slow and cumbersome process. Most often, you&rsquo;re stuck maintaining them using the web interface provided by the DNS vendor. The more domains and DNS records you manage, the higher the probability that one or more entries will be neglected. Here&rsquo;s why it&rsquo;s important to keep your DNS records current and prevent a subdomain takeover attack. </p>
<h2>What is Subdomain Takeover Attack?</h2>
<p>A DNS record becomes stale when the resource it points to is no longer under your control. The A record is the most common type of these "dangling" DNS misconfigurations found in the wild. DNS A records that point to an IP address belonging to a hosting service with a high turnover rate, such as Digital Ocean or Linode, are much more susceptible to a <a href="https://blog.apnic.net/2019/01/09/be-careful-where-you-point-to-the-dangers-of-stale-dns-records/">subdomain takeover attack</a>. </p>
<p>For example, you may have set up a test copy of your web site using the subdomain test.example.com and created a DNS A record pointed at a Linode VM. But, you forgot to delete the DNS record after completing your test and destroying the VM. </p>
<p>The hosting company is going to reallocate that IP address to another resource in the near future. If the new owner of the IP address has ill intentions, your domain&rsquo;s reputation is in danger.</p>
<h2>How is a stale DNS record discovered?</h2>
<p>To exploit a stale DNS record, the attacker has to do a bit of fishing. The first step is to create a virtual machine, which will be allocated an IP address. </p>
<p>The second step is to set up a web server and monitor web traffic. A basic out-of-the-box web site configuration is all that is needed. Because the attacker doesn&rsquo;t care what web page is served up. They only care about what shows up in the logs. </p>
<p>Once the VM and web server are up and running, they simply monitor the logs and wait for something to pop up. All it takes is one request &mdash; from a bot, a probe, or a random google search &mdash; for the attacker to discover the subdomain pointed at their IP address.</p>
<p>With VMs costing as little as $5 per month, it&rsquo;s quite easy for an attacker to spin up several VMs and leave them monitoring multiple IP addresses for a few days. If the web server logs don't show any hits after a few days, they simply destroy the VM, create a new one, and move on to another IP. </p>
<h2>How is a stale DNS record exploited?</h2>
<p>Now that the attacker has access to a web server receiving traffic directed at one of your subdomains, they can set up their own web site that piggybacks on the reputation of your domain. The first thing they will do is create a free SSL certificate using a service like <a href="https://letsencrypt.org/">Let&rsquo;s Encrypt</a>. This increases the legitimacy of whatever content they decide to host. </p>
<p>Next, they&rsquo;ll upload the contents of the web site that will be masquerading under your subdomain. For example, they could create a form that mimics your web site to trick visitors into entering personal information. The unsuspecting visitors will have no idea the information they submit is being delivered to a nefarious third party.</p>
<p>Another thing they could do is upload a slew of spammy content, verify the subdomain with google, and submit it for indexing. Anyone searching on google, will see the subdomain as being reputable and therefore more likely to click on the results that appear during their search. </p>
<h2>How to keep DNS records from going stale</h2>
<p>The solution is to regularly audit your DNS records and identify any subdomains that are no longer in use. Before you delete them, however, make sure the subdomain isn&rsquo;t already being exploited. If it is, it may be necessary to repoint the record to an IP you control to reclaim ownership of the subdomain. </p>
<p>The final step is to delete any stale DNS records that you find during your audit. </p>
<p>Another solution that helps is to enable Google Search Console for your domains and configure it to alert you if anyone claims authority over one of your subdomains.</p>
<footer class="post-info">
        <abbr class="published" title="2024-10-15T00:00:00-07:00">
                Published: Tue 15 October 2024
        </abbr>

<p class="tags">Tags: <a href="https://jjriv.com/dns/">DNS</a> </p>
</footer><!-- /.post-info -->    </div><!-- /.entry-content -->

  </article>
</section>
            </div>
        </div>
    </main>

    <footer class="container">
            jjriv.com is powered by <a href="https://getpelican.com/">Pelican</a> &amp; <a href="https://picocss.com/">Pico</a> 
            <svg fill="none" height="17" viewBox="0 0 1020 960" xmlns="http://www.w3.org/2000/svg"><path d="m768.296 576.809c-5.281 2.031-9.455 6.205-11.487 11.487l-78.142 203.17c-6.575 17.094-30.759 17.094-37.334 0l-78.142-203.17c-2.032-5.282-6.206-9.456-11.487-11.487l-203.17-78.142c-17.094-6.575-17.094-30.76 0-37.334l203.17-78.142c5.281-2.032 9.455-6.206 11.487-11.487l78.142-203.17c6.575-17.094 30.759-17.094 37.334 0l78.142 203.17c2.032 5.281 6.206 9.455 11.487 11.487l203.17 78.142c17.094 6.575 17.094 30.759 0 37.334z" fill="#ffbf00"/><g fill="#ff9500"><path d="m198.667 311.466c-6.575 17.094-30.759 17.094-37.334 0l-28.142-73.17c-2.032-5.282-6.206-9.456-11.487-11.487l-73.1699-28.142c-17.0939-6.575-17.094-30.759-.0001-37.334l73.17-28.142c5.281-2.032 9.455-6.206 11.487-11.487l28.142-73.1701c6.575-17.0939 30.759-17.0938 37.334 0l28.142 73.1701c2.032 5.281 6.206 9.455 11.487 11.487l73.17 28.142c17.094 6.575 17.094 30.759 0 37.334l-73.17 28.142c-5.281 2.031-9.455 6.205-11.487 11.487z"/><path d="m358.296 826.809c-5.281 2.031-9.455 6.205-11.487 11.487l-28.142 73.17c-6.575 17.094-30.759 17.094-37.334 0l-28.142-73.17c-2.032-5.282-6.206-9.456-11.487-11.487l-73.17-28.142c-17.094-6.575-17.094-30.76 0-37.334l73.17-28.142c5.281-2.032 9.455-6.206 11.487-11.488l28.142-73.169c6.575-17.094 30.759-17.094 37.334 0l28.142 73.169c2.032 5.282 6.206 9.456 11.487 11.488l73.17 28.142c17.094 6.574 17.094 30.759 0 37.334z"/></g></svg>
    </footer>

</body>
</html>